#
#  Makefile.sub.in - Common rules and definitions
#
#  $Id$
#
#  Copyright (C) 1998 Cees de Groot <cg@sgmltools.org>
#

top_builddir=/home/ian/OPENJADE/cvs/jade
TOP=/home/ian/OPENJADE/cvs/jade
prefix=/usr
exec_prefix=${prefix}
srcdir=.
bindir=${exec_prefix}/bin
libdir=${exec_prefix}/lib
datadir=/usr/share/sgml/openjade-1.3.1

CXX=g++
CC=gcc
PERL=/usr/bin/perl
LIBTOOL=$(SHELL) $(top_builddir)/libtool
INSTALL=/usr/bin/install -c

LIBOBJS=
LIBS= -lnsl
DEFS=-DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STRUCT_STAT_ST_BLKSIZE=1 -DHAVE_ST_BLKSIZE=1 -DSIZEOF_SIZE_T=4 -DSIZEOF_UNSIGNED_INT=4 -DSP_HAVE_LOCALE=1 -DSP_HAVE_WCHAR=1 -DSP_HAVE_GETTEXT=1 -DSP_HAVE_BOOL=1 -DSP_ANSI_CLASS_INST=1 -DSP_HAVE_SOCKET=1 -DJADE_MIF=1 -DJADE_HTML=1 -DSP_MULTI_BYTE=1 -DSGML_CATALOG_FILES_DEFAULT=\"/etc/sgml/catalog\" -DSGML_SEARCH_PATH_DEFAULT=\"/usr/share/sgml\" -DHAVE_DLFCN_H=1  -DDEFAULT_SCHEME_BUILTINS=\"${datadir}/builtins.dsl\"
INCS=-I$(srcdir) -I$(srcdir)/../include $(INCLUDE)
CXXFLAGS=-O2 -fno-implicit-templates $(INCS) $(DEBUG) $(DEFS)
CFLAGS=-g -O2 $(DEBUG) $(DEFS)
LDFLAGS=
MSGGENFLAGS=
CXXDEPGENFLAGS=-MM

.SUFFIXES: .cxx .c .o .m4 .msg .lo

.cxx.o:
	$(CXX) $(CXXFLAGS) -c $<

.cxx.lo:
	@$(LIBTOOL) --mode=compile $(CXX) $(CXXFLAGS) -c $<

.c.o:
	$(CC) $(CFLAGS) -c $<

.c.lo:
	@$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c $<

.m4.cxx:
	rm -f $@
	$(PERL) $(srcdir)/../lib/instmac.pl $< >$@
	chmod -w $@

%.h %.cxx %.rc: %.msg
	$(PERL) -w $(srcdir)/../msggen.pl $(MSGGENFLAGS) $<

.msg.h:
	$(PERL) -w $(srcdir)/../msggen.pl $(MSGGENFLAGS) $<

depend_src: depend.temp
	mv depend.temp Makefile.dep

depend.temp: FORCE
	$(CXX) -MM $(CXXFLAGS) $(CXXDEPGENFLAGS) $(OBJS:.o=.cxx) \
	  | sed -e 's; \([^/ ][^/ ]*\)/; $$(srcdir)/\1/;g' >depend.temp1
	cat depend.temp1 > depend.temp
	cat depend.temp1 | sed -e 's/\.o:/.lo:/g' >> depend.temp
	rm depend.temp1

clean: FORCE
	-rm -f $(CLEANFILES)

FORCE:

%: RCS/%,v
	test -w $@ || co -u $@
